{% extends "base.html" %}
{% block title %}{{ book.title }} – LitMapper{% endblock %}
{% block content %}
<article class="book-detail">
    <!-- Title + Date -->
    <header class="book-header">
        <h1 class="book-title">{{ book.title }}</h1>
        <p class="book-author">by {{ book.author }}</p>
        {% if book.date_posted %}
        <div class="book-date">
            Posted on {{ book.date_posted }}
        </div>
        {% endif %}
    </header>

    <!-- Cover + Summary/Thoughts -->
    <div class="book-summary-wrapper">
        {% if book.cover %}
        <img class="book-cover" 
             src="{{ url_for('static', filename='images/books/' + book.cover) }}" 
             alt="Cover of {{ book.title }} by {{ book.author }}">
        {% endif %}
        
        <section class="book-summary">
            <h2>Summary</h2>
            {% if book.summary is string %}
                <p>{{ book.summary }}</p>
            {% else %}
                <p>{{ book.summary | join(' ') }}</p>
            {% endif %}

            <h3>My Thoughts</h3>
            {% if book.thoughts is string %}
                <p>{{ book.thoughts }}</p>
            {% else %}
                <p>{{ book.thoughts | join(' ') }}</p>
            {% endif %}
        </section>
    </div>

    <!-- Map -->
    {% if book.map %}
    <section class="book-map">
        <h2>Map</h2>
        <img src="{{ url_for('static', filename='images/maps/' + book.map) }}" 
             alt="Map visualization for {{ book.title }}">
        
        {% if book.map_notes %}
        <div class="book-map-notes">
            {% if book.map_notes is string %}
                <p>{{ book.map_notes }}</p>
            {% else %}
                <p>{{ book.map_notes | join(' ') }}</p>
            {% endif %}
        </div>
        {% endif %}
    </section>
    {% endif %}

    <!-- Code Notes (before notebook for better flow) -->
    {% if book.code_notes %}
    <section class="book-code-notes">
        <h2>Coding Notes</h2>
        {% if book.code_notes is string %}
            <p>{{ book.code_notes }}</p>
        {% else %}
            <p>{{ book.code_notes | join(' ') }}</p>
        {% endif %}
    </section>
    {% endif %}

    <!-- Full Code / Notebook -->
    {% if book.notebook %}
    <section class="book-notebook">
        <h2>Full Code</h2>
        <div class="notebook-wrapper">
            <iframe src="{{ url_for('static', filename='notebooks/' + book.notebook) }}"
                    title="Jupyter notebook for {{ book.title }}"></iframe>
        </div>
    </section>
    {% endif %}

    <a href="{{ url_for('index') }}" class="back-link">← Back to all books</a>
</article>
{% endblock %}